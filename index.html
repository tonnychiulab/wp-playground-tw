<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WP Playground TW - 快速啟動器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-gray-100 h-screen flex overflow-hidden">

    <!-- Sidebar Configuration -->
    <aside
        class="w-full md:w-80 bg-white border-r border-gray-200 flex flex-col h-full shadow-lg z-20 overflow-hidden shrink-0 transition-all duration-300 transform -translate-x-full md:translate-x-0 absolute md:relative"
        id="sidebar">
        <!-- Header -->
        <div class="p-4 border-b border-gray-100 shrink-0 flex justify-between items-start">
            <div>
                <h1 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                    <span class="bg-blue-600 text-white p-1 rounded">WP</span>
                    Playground TW
                </h1>
                <p class="text-xs text-gray-500 mt-1">WordPress 繁體中文快速試用環境</p>
            </div>
            <!-- Desktop Collapse Button -->
            <button onclick="toggleSidebarDesktop()"
                class="hidden md:block text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                        d="M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 010 1.414zm-6 0a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 1.414L5.414 10l4.293 4.293a1 1 0 010 1.414z"
                        clip-rule="evenodd" />
                </svg>
            </button>
        </div>

        <!-- Form -->
        <div class="p-4 space-y-5 flex-1 overflow-y-auto">

            <!-- Quick Presets -->
            <div class="bg-blue-50 p-3 rounded-lg border border-blue-100">
                <h3 class="text-xs font-semibold text-blue-600 uppercase tracking-wider mb-2">一鍵快速設定</h3>
                <div class="flex gap-2">
                    <button onclick="applyPreset('commerce')"
                        class="flex-1 bg-white border border-blue-200 text-blue-700 text-xs py-1.5 px-3 rounded hover:bg-blue-50 transition-colors shadow-sm">
                        🛒 開店包
                    </button>
                    <button onclick="applyPreset('blog')"
                        class="flex-1 bg-white border-blue-200 text-blue-700 text-xs py-1.5 px-3 rounded hover:bg-blue-50 transition-colors shadow-sm">
                        📝 部落格
                    </button>
                </div>
            </div>

            <!-- Versions -->
            <div class="space-y-4">
                <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider">核心設定</h3>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">PHP 版本</label>
                    <select id="phpVersion"
                        class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5">
                        <option value="7.4">PHP 7.4</option>
                        <option value="8.0">PHP 8.0</option>
                        <option value="8.1">PHP 8.1</option>
                        <option value="8.2" selected>PHP 8.2 (推薦)</option>
                        <option value="8.3">PHP 8.3</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">WordPress 版本</label>
                    <select id="wpVersion"
                        class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5">
                        <option value="latest" selected>Latest (最新版)</option>
                        <option value="nightly">Nightly (開發版)</option>
                    </select>
                </div>
            </div>

            <!-- System Warning Container -->
            <div id="systemWarning" class="hidden bg-orange-50 border-l-4 border-orange-400 p-3">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg class="h-4 w-4 text-orange-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                            fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                                clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="ml-3">
                        <p class="text-xs text-orange-700">
                            <span class="font-bold">記憶體不足警告</span><br>
                            您的裝置記憶體較少 (<span id="ramSize"></span>GB)，建議不要同時安裝過多外掛，以免瀏覽器崩潰。
                        </p>
                    </div>
                </div>
            </div>

            <hr class="border-gray-100">

            <!-- Plugins & Themes -->
            <div class="space-y-4">
                <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider">擴充功能</h3>

                <!-- Tabs Header -->
                <div class="flex border-b border-gray-200">
                    <button onclick="switchTab('featured')" id="tab-btn-featured"
                        class="tab-btn flex-1 py-2 text-xs font-medium text-blue-600 border-b-2 border-blue-600 focus:outline-none transition-colors flex items-center justify-center gap-1">
                        推薦 <span id="count-featured"
                            class="hidden px-1.5 py-0.5 bg-blue-100 text-blue-600 rounded-full text-[10px]">0</span>
                    </button>
                    <button onclick="switchTab('store')" id="tab-btn-store"
                        class="tab-btn flex-1 py-2 text-xs font-medium text-gray-500 hover:text-gray-700 border-b-2 border-transparent focus:outline-none transition-colors flex items-center justify-center gap-1">
                        開店 <span id="count-store"
                            class="hidden px-1.5 py-0.5 bg-blue-100 text-blue-600 rounded-full text-[10px]">0</span>
                    </button>
                    <button onclick="switchTab('themes')" id="tab-btn-themes"
                        class="tab-btn flex-1 py-2 text-xs font-medium text-gray-500 hover:text-gray-700 border-b-2 border-transparent focus:outline-none transition-colors flex items-center justify-center gap-1">
                        佈景 <span id="count-themes"
                            class="hidden px-1.5 py-0.5 bg-blue-100 text-blue-600 rounded-full text-[10px]">0</span>
                    </button>
                    <button onclick="switchTab('tools')" id="tab-btn-tools"
                        class="tab-btn flex-1 py-2 text-xs font-medium text-gray-500 hover:text-gray-700 border-b-2 border-transparent focus:outline-none transition-colors flex items-center justify-center gap-1">
                        工具 <span id="count-tools"
                            class="hidden px-1.5 py-0.5 bg-blue-100 text-blue-600 rounded-full text-[10px]">0</span>
                    </button>
                </div>

                <!-- Tab Content: Featured -->
                <div id="tab-featured" class="plugin-tab space-y-2">
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="elementor"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">Elementor</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="classic-editor"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">Classic
                            Editor</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="akismet"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">Akismet
                            Spam</span>
                    </label>
                </div>

                <!-- Tab Content: Store -->
                <div id="tab-store" class="plugin-tab space-y-2 hidden">
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="woocommerce"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span
                            class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">WooCommerce</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="wordpress-seo"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">Yoast SEO</span>
                    </label>
                </div>

                <!-- Tab Content: Themes -->
                <div id="tab-themes" class="plugin-tab space-y-2 hidden">
                    <p class="text-xs text-gray-400 mb-2">只能選擇一個主題</p>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="radio" name="theme-radio" value="astra"
                            class="theme-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">Astra</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="radio" name="theme-radio" value="generatepress"
                            class="theme-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                        <span
                            class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">GeneratePress</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="radio" name="theme-radio" value="oceanwp"
                            class="theme-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">OceanWP</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="radio" name="theme-radio" value=""
                            class="theme-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"
                            checked>
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">預設 (Twenty
                            Twenty-Four)</span>
                    </label>
                </div>

                <!-- Tab Content: Tools -->
                <div id="tab-tools" class="plugin-tab space-y-2 hidden">
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="query-monitor"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">Query
                            Monitor</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer group">
                        <input type="checkbox" value="wp-crontrol"
                            class="plugin-check w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <span class="text-sm text-gray-700 group-hover:text-blue-600 transition-colors">WP
                            Crontrol</span>
                    </label>
                </div>
            </div>

            <hr class="border-gray-100">

            <!-- Defaults -->
            <div class="space-y-4">
                <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider">預設設定</h3>
                <div class="space-y-3">
                    <div>
                        <label class="block text-xs font-medium text-gray-500 mb-1">語系</label>
                        <div class="text-sm text-gray-800 flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                            繁體中文 (zh_TW)
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-500 mb-1">時區</label>
                        <div class="text-sm text-gray-800 flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                            Asia/Taipei (UTC+8)
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="p-4 border-t border-gray-100 bg-gray-50 shrink-0 space-y-2">
            <button id="launchBtn" onclick="launchPlayground()"
                class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-3 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                <svg id="btnIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                    fill="currentColor">
                    <path fill-rule="evenodd"
                        d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                        clip-rule="evenodd" />
                </svg>
                <svg id="btnSpinner" class="animate-spin h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg"
                    fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                </svg>
                <span id="launchText">啟動環境</span>
            </button>
            <button onclick="showBlueprint()"
                class="w-full bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium rounded-lg text-xs px-3 py-2 transition-colors">
                <span class="font-mono">{}</span> 檢視藍圖 JSON
            </button>
            <div class="mt-2 text-center text-xs text-gray-500">
                <span>WP Playground TW v1.0.0</span><br>
                初次載入可能需要 15-30 秒
            </div>
        </div>
    </aside>

    <!-- Overlay for mobile sidebar -->
    <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-0 hidden md:hidden"
        onclick="toggleSidebar()"></div>

    <!-- Main Content / Preview -->
    <main class="flex-1 relative flex flex-col h-full overflow-hidden">

        <!-- Desktop Expand Button -->
        <button id="expandBtn" onclick="toggleSidebarDesktop()"
            class="hidden absolute top-4 left-4 z-30 bg-white p-2 rounded-lg shadow-md border border-gray-200 text-gray-600 hover:text-blue-600 hover:border-blue-300 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>

        <!-- Mobile Header -->
        <header class="bg-white border-b border-gray-200 p-4 flex justify-between items-center md:hidden shrink-0">
            <div class="font-bold text-gray-800">WP Playground TW</div>
            <button onclick="toggleSidebar()" class="text-gray-600 hover:text-gray-900">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </header>

        <!-- Status / Loading -->
        <div id="statusContainer" class="absolute inset-0 flex items-center justify-center bg-gray-50 z-20">
            <div class="text-center max-w-sm px-4">
                <div id="loader"
                    class="hidden mb-6 mx-auto w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin">
                </div>
                <div id="welcomeState">
                    <div class="bg-white p-4 rounded-full inline-block shadow-sm mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-600" viewBox="0 0 20 20"
                            fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"
                                clip-rule="evenodd" />
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">準備就緒</h2>
                    <p class="text-gray-600 mb-6">請在左側選擇您的 WordPress 環境配置，然後點擊「啟動環境」。</p>
                    <button
                        onclick="sidebar.classList.remove('-translate-x-full'); sidebarOverlay.classList.remove('hidden');"
                        class="md:hidden text-blue-600 font-medium hover:underline">
                        開啟設定選單 &rarr;
                    </button>
                </div>
                <div id="loadingState" class="hidden">
                    <h2 class="text-xl font-bold text-gray-800 mb-2">正在建置環境...</h2>
                    <p class="text-gray-600 text-sm">正在下載核心、安裝外掛並設定繁體中文環境。</p>
                </div>
            </div>
        </div>

        <!-- The Iframe -->
        <iframe id="wpFrame" class="w-full h-full border-0 absolute inset-0 z-10 hidden bg-white"
            title="WordPress Playground"></iframe>
    </main>

    <!-- Blueprint Modal -->
    <div id="blueprintModal"
        class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center">
                <h3 class="font-bold text-gray-800">Blueprint JSON</h3>
                <button onclick="document.getElementById('blueprintModal').classList.add('hidden')"
                    class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-4 flex-1 overflow-auto bg-gray-50">
                <pre id="blueprintCode" class="text-xs font-mono text-gray-600 whitespace-pre-wrap break-all"></pre>
            </div>
            <div class="p-4 border-t border-gray-100 bg-gray-50 flex flex-wrap gap-2 justify-end">
                <button onclick="shareLine()"
                    class="bg-[#06C755] text-white px-4 py-2 rounded text-sm hover:bg-[#05b54c] transition flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M24 10.304c0-5.369-5.383-9.738-12-9.738-6.616 0-12 4.369-12 9.738 0 4.814 4.269 8.846 10.036 9.608.391.084.922.258 1.057.592.121.3.079.766.035 1.055-.06.402-.271 1.581-.412 2.164-.207.863-.984 2.105.8 1.151 1.764-.943 5.378-3.085 7.394-5.24C21.996 17.544 24 14.159 24 10.304z" />
                    </svg>
                    Line
                </button>
                <button onclick="copyUrl()"
                    class="bg-gray-700 text-white px-4 py-2 rounded text-sm hover:bg-gray-800 transition flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" height="20" width="20" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M7.5 18A5.5 5.5 0 0 1 2 12.5A5.5 5.5 0 0 1 7.5 7H10V9H7.5A3.5 3.5 0 0 0 4 12.5A3.5 3.5 0 0 0 7.5 16H10V18H7.5M16.5 16A3.5 3.5 0 0 0 20 12.5A3.5 3.5 0 0 0 16.5 9H14V7H16.5A5.5 5.5 0 0 1 22 12.5A5.5 5.5 0 0 1 16.5 18H14V16H16.5M10 13V11H14V13H10Z" />
                    </svg>
                    複製連結
                </button>
                <button onclick="downloadBlueprint()"
                    class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                    下載 JSON
                </button>
                <button onclick="document.getElementById('blueprintModal').classList.add('hidden')"
                    class="bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded text-sm hover:bg-gray-50 transition">關閉</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>